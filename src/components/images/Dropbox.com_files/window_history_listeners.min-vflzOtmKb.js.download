define(["require","exports","tslib","metaserver/static/js/ux_analytics/lazy_ux_analytics","metaserver/static/js/ux_analytics/dispatch_custom_event"],(function(t,e,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.installHistoryListeners=e.lib=e.SPA_HISTORY_STATE_CHANGE=void 0,l=a.__importStar(l),e.SPA_HISTORY_STATE_CHANGE="SPAHistoryStateChange";const i=t=>{const a={detail:{eventSource:t}};(0,s.runAfterUxaListening)(()=>{l.dispatchCustomEvent(e.SPA_HISTORY_STATE_CHANGE,a)})},n=history.pushState,o=history.replaceState,r=t=>{i("popState")};e.lib={oldReplaceState:o,oldPushState:n,resetHistoryListenersInstalled:()=>{self._DBX_UXA_historyListenersInstalled=!1},getHistoryListenersInstalled:()=>self._DBX_UXA_historyListenersInstalled,installPushStateMonkeyPatch:()=>{Object.defineProperty(history,"pushState",{value:(t,a,s)=>{const l=location.pathname+location.hash;e.lib.oldPushState.call(history,t,a,s),l!==location.pathname+location.hash&&i("pushState")},writable:!0})},installReplaceStateMonkeyPatch:()=>{Object.defineProperty(history,"replaceState",{value:(t,a,s)=>{const l=location.pathname+location.hash;e.lib.oldReplaceState.call(history,t,a,s),l!==location.pathname+location.hash&&i("replaceState")},writable:!0})}};e.installHistoryListeners=()=>{self._DBX_UXA_historyListenersInstalled||(e.lib.installPushStateMonkeyPatch(),e.lib.installReplaceStateMonkeyPatch(),window.addEventListener("popstate",r),self._DBX_UXA_historyListenersInstalled=!0)}}));
//# sourceMappingURL=window_history_listeners.min.js-vflA7Ho4s.map