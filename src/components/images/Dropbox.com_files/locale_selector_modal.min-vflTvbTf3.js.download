define(["require","exports","tslib","react","metaserver/static/js/clean/intl_router_utils","metaserver/static/js/components/ui/css","metaserver/static/js/clean/ui/modal_dig","metaserver/static/js/components/ui/modal_controller","metaserver/static/js/modules/constants/locales","metaserver/static/js/core/browser","metaserver/static/js/core/i18n","@dropbox/dig-components/buttons","metaserver/static/js/clean/active_user","metaserver/static/js/core/notify","metaserver/static/js/deprecated_ajax/ajax_jquery","metaserver/static/js/core/uri"],(function(e,t,a,l,s,o,c,r,n,i,d,u,m,_,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocaleSelectorModal=t.LocaleTag=t.showModal=void 0,l=a.__importDefault(l),r=a.__importStar(r),n=a.__importStar(n),i=a.__importStar(i),h=a.__importStar(h);t.showModal=(e,a=!1,s=!0,o=!1)=>r.mountModal(l.default.createElement(t.LocaleSelectorModal,{source:e,isTeamAdminSettingsConsole:a,shouldAllowInternalLocales:s,shouldUseDigButtons:o}));t.LocaleTag=({locale:e})=>{const{decorator:t,localeCode:a}=e;let{localeName:s}=e;return""!==t&&(s+=` [${t}]`),l.default.createElement("span",{"data-locale":a},s)},t.LocaleTag.displayName="LocaleTag",t.LocaleTag.displayName="LocaleTag";class g extends l.default.Component{constructor(){super(...arguments),this.handleCloseModal=()=>history.pushState("",document.title,i.get_href_no_hash()),this.handleLocaleSelected=e=>t=>(t.preventDefault(),history.pushState("",document.title,i.get_href_no_hash()),r.unmountModal(),((e,t,a=!1)=>{const l=a?"/team/admin/set_locale":"/set_locale";return _.Notify.success(d.intl.formatMessage({id:"wQFLxr",defaultMessage:"Changing language..."})),h.SilentBackgroundRequest(Object.assign({url:new p.URI({path:l}),data:{locale:e,locale_cont:t},success:()=>i.redirect(t)},a&&{subject_user:(0,m.mustGetActiveUserId)()}))})(e,i.get_href_no_hash(),this.props.isTeamAdminSettingsConsole)),this.renderLocale=(e,a,o)=>{if(a)return l.default.createElement("li",{key:e.localeCode},l.default.createElement("a",{href:(0,s.getCurrentPathWithLocaleCode)(e.localeCode)},l.default.createElement(t.LocaleTag,{locale:e})));{const a="locale-option button-as-link react-locale-selector-modal__list-item-button";return l.default.createElement("li",{key:e.localeCode},o?l.default.createElement(u.Button,{className:a,onClick:this.handleLocaleSelected(e.localeCode),variant:"transparent",hasNoUnderline:!0,"data-uxa-log":`locale_tag_${e.localeCode}_${this.props.source}`},l.default.createElement(t.LocaleTag,{locale:e})):l.default.createElement("button",{className:a,onClick:this.handleLocaleSelected(e.localeCode),"data-uxa-log":`locale_tag_${e.localeCode}_${this.props.source}`},l.default.createElement(t.LocaleTag,{locale:e})))}},this.renderLocaleList=()=>{const{shouldAllowInternalLocales:e,shouldUseDigButtons:t}=this.props,a=(0,s.isIntlRouterPath)(),o=e?n.LIST_OF_LOCALES_WITH_INTERNAL:n.LIST_OF_LOCALES_WITHOUT_INTERNAL;return l.default.createElement("div",{className:"react-locale-selector-modal"},l.default.createElement("ul",{className:"react-locale-selector-modal__list u-unlist u-trim-padding"},o.map(e=>this.renderLocale(e,a,t))))}}render(){return l.default.createElement(c.Modal,{id:"locale-selector-modal",ref:"modal",className:"uxa-modal",onDismissCompleted:this.handleCloseModal,title:d.intl.formatMessage({id:"tVLdyJ",defaultMessage:"Choose a language:"}),acceptButtonText:null,style:"default"},this.renderLocaleList())}}g.displayName="LocaleSelectorModal",t.LocaleSelectorModal=(0,o.requireCssWithComponent)(g,["/static/metaserver/static/css/components/react_locale_selector-vflsUmZSq.css","/static/metaserver/static/css/font_atlas_grotesk-vflDjs7Mh.css","/static/metaserver/static/css/font_sharp_grotesk-vflU6KIR2.css","/static/metaserver/static/css/modal-vflf1hwfZ.css"])}));
//# sourceMappingURL=locale_selector_modal.min.js-vfl1UFXyf.map